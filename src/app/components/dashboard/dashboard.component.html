<p *ngIf="user">Welcome {{ user.email }}!</p>
<p *ngIf="user">{{ user.uid }} </p>
<div *ngIf="!user">
  <label>Email</label>
  <input type="email" [(ngModel)]="model.userEmail">
  <label>Password</label>
  <input type="password" [(ngModel)]="model.userPassword">
  <input type="button" (click)="signin()" value="Sign In">
  <input type="button" (click)="signup()" value="Sign Up">
</div>

<div class="dashboard container">

  <!-- ACTION BUTTON - fab button to add bike, import bike, add component -->
  <!-- <md-fab-speed-dial md-direction="up" class="md-scale md-fab-bottom-right" >
      <md-fab-trigger>
          <md-button aria-label="Add..." class="md-fab md-warn">
              <md-icon md-font-icon="material-icons">add</md-icon>
              <md-tooltip md-direction="left">Add...</md-tooltip>
          </md-button>
      </md-fab-trigger>

      <md-fab-actions>
          <md-button ng-if="currentBike" class="fabButton md-icon-button" ng-click="sendToAddComponent()">
              <md-icon class="speedDialButtonIcon" md-svg-src="/images/noun_168563_cc-crankset.svg"></md-icon>
              <md-tooltip md-direction="left">Add New Component</md-tooltip>
          </md-button>
          <md-button aria-label="Add Bike" class="fabButton md-icon-button" ng-click="sendToAddBike()">
              <md-icon class="md-icon-button speedDialButtonIcon" md-svg-src="/images/noun_1067030_cc.svg"></md-icon>
              <md-tooltip md-direction="left">Add New Bike</md-tooltip>
          </md-button>

          <md-button ng-if="currentUserProfile.stravaId" class="fabButton md-icon-button" ng-click="importBikes()">
              <md-icon class="md-icon-button speedDialButtonIcon" md-svg-src="/images/noun_1067030_cc.svg" style="color: tomato;"></md-icon>
              <md-tooltip md-direction="left">Import Bike from Strava</md-tooltip>
          </md-button>

      </md-fab-actions>
  </md-fab-speed-dial> -->
    <div class="d-flex flex-row justify-content-end">
      <div class="dashboard__refresh">
        <button mat-icon-button (click)="refresh()" class="">
          <mat-icon matTooltip="Refresh" aria-label="Button to refresh the dashboard">autorenew</mat-icon>
        </button>
      </div>
    </div>

    <div class="d-flex flex-row justify-content-center">
      <div class="dashboard__header" class="">
        <img src="./assets/images/bikeHeader_dreamstime_71468702_web.png" class="dashboard__headerImage" alt="BikeTracker Icon" />
      </div>
    </div>

    <!-- Progress meter -->
    <!-- <div ng-show="progressFlag" ng-hide="!progressFlag" class="progressSVG">
      <img src="./assets/images/progressGear.svg" alt="Loading Content" id="svgspin" />
    </div>
     -->
  


  <div class="row dashboard__content">

    <div class="bikeView">
      <div ng-show="bikes.length !== 0" class="bikeView__dropdown">
        <mat-form-field class="bikeView__dropdown-ic">
          <mat-select [(ngModel)]="currentBike" (ngModelChange)="getComponents()" id="currentBikeSelector" placeholder="Choose a Bike" aria-placeholder="Choose a Bike">
            <mat-optgroup label="Bikes">
              <mat-option [value]="bike" *ngFor="let bike of bikes"> {{ bike.brandName }} {{ bike.modelName }}</mat-option>
            </mat-optgroup>
            <mat-option (click)="sendToAddBike()">
              <span> Add A New Bike... </span>
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>

  <!-- <div ng-if="!currentUserProfile">
        <h2>Create a user profile first, then add a bike.</h2>
        <md-button ng-href="/#!/profile" class="md-raised md-primary">Create Profile</md-button>
      </div>
    
    <div ng-show="bikes.length === 0 && currentUserProfile" class="bikeView__addBikeButtons " layout="column">
      <h2 ng-if="!currentUserProfile.stravaId">Add a bike to start tracking your components. </h2>
      <md-button class="md-raised md-primary" ng-click="sendToAddBike()">Add A Bike</md-button>
      <h2 ng-if="!currentUserProfile.stravaId">Or link your Strava account on your Profile Page to import your saved bikes.</h2>
      <h2 ng-if="currentUserProfile.stravaId">Choose an option to start tracking a bike and it's components.</h2>
      <md-button ng-if="!currentUserProfile.stravaId" class="md-raised" ng-href="/#!/profile">Profile</md-button>
      <md-button ng-if="currentUserProfile.stravaId" class="md-raised md-warn" ng-click="importBikes()">Import Bike from Strava</md-button>
    </div>
  -->
      <mat-card *ngIf="currentBike" class="bikeView__details" id="currentBikeDetails">
        <mat-card-title>
          <h2>
            <!-- <mdi-icon mdi-svg-src="/images/noun_1067030_cc.svg" style="width: 50px; height: auto" class="bikeView__icon"></mdi-icon> -->
            <span class="bikeView__bikeHeader"> {{ currentBike.brandName }} {{ currentBike.modelName}}</span>
            <mat-menu #appMenu="matMenu">
              <button mat-menu-item (click)="sendToEditBike(currentBike)" aria-label="Edit Bike">
                <mat-icon>mode_edit</mat-icon>Edit
              </button>
              <button mat-menu-item (click)="showConfirmBike($event, currentBike)" aria-label="Delete Bike">
                <mat-icon>delete</mat-icon>Delete
              </button>
            </mat-menu>
            <button mat-icon-button aria-label="Bike menu" class="md-icon-button dotCtrlMenu" [matMenuTriggerFor]="appMenu">
                <mat-icon>more_vert</mat-icon>
            </button>
          </h2>
        </mat-card-title>
        <mat-card-content>
          <div>
            <span class="bikeView__mileage">Mileage: {{currentBike.mileage}} miles</span>
            <span *ngIf="!(currentBike)?.stravaBikeId" class="addMileageBtn">
              <button mat-button class="mat-raised mat-accent addMileageBtn" (click)="addMileageModal()">Add Mileage</button>
            </span>
            <span>
              <!-- <mat-icon *ngIf="currentBike.stravaBikeId" mat-svg-src="./images/api_logo_pwrdBy_strava_horiz_light.svg" class="poweredByStravaIcon"></mat-icon> -->
              <!-- <mat-tooltip md-direction="top" md-delay="600">Mileage synced with Strava</mat-tooltip> -->
            </span>
          </div>
          <br>
          <br>
          <mat-accordion class="vAccordion--default bikeView__extraDetails">
            <mat-expansion-panel>
              <mat-expansion-panel-header>
                <mat-panel-title>
                  More Details...
                </mat-panel-title>
              </mat-expansion-panel-header>
              
              <div>
                <span *ngIf="currentBike.serial">
                  <h5>Serial Number:</h5>
                  <p>{{currentBike.serial}}</p>
                </span>
                <span *ngIf="currentBike.purchaseDate">
                  <h5>Purchased:</h5>
                  <p> {{currentBike.purchaseDate | date}}</p>
                </span>
                <span *ngIf="currentBike.notes">
                  <h5>Notes:</h5>
                  <p> {{currentBike.notes}}</p>
                </span>
              </div>
            </mat-expansion-panel>
            <mat-expansion-panel>
              <mat-expansion-panel-header>
                Images
              </mat-expansion-panel-header>
              <div class="row justify-space-around">
                <div *ngFor="let image of currentBike.images" class="bikeImages__bikeImageWhiteBox">
                  <img [src]="image" class="bikeImages__bikeImage" (click)="displayPhoto($event)"/>
                </div>
              </div> 
            </mat-expansion-panel>
          </mat-accordion>
        </mat-card-content>
      </mat-card>
    </div>
  </div>
  <!-- End of Bike View Section -->
  
  <mat-divider *ngIf="currentBike"></mat-divider>
  <!--

<!-- Component Section -->
  <div *ngIf="components" class="componentView">
    <div class="componentView__componentSearchSort">
      <span class="componentSearchSort__componentSearch">
        <mat-form-field class="componentSearch__input">
          <input matInput type="search" placeholder="Search Components" [(ngModel)]="componentSearch" id="searchComponentInput" aria-label="Search Bike Components" />
          <button mat-button *ngIf="componentSearch" matSuffix mat-icon-button aria-label="Clear" (click)="componentSearch=''">
            <mat-icon>close</mat-icon>
          </button>
        </mat-form-field>
      </span>
    
      <span class="componentSearchSort__componentSortBy">
        <mat-form-field class="componentSearchSort__sortDropDown">
          <!-- in AngularJS I used a "trackBy" property on this select. Is there an equivalent in Angular 2+? -->
          <mat-select [(ngModel)]="sortSelector" (ngModelChange)="setSortOrder(sortSelector)" placeholder="Sort Components" aria-label="Sort Components By">
            <mat-option [value]="sort" *ngFor="let sort of sortOrderArray">{{ sort.title }}</mat-option>
          </mat-select>
        </mat-form-field>
      </span>
      <span>
        <mat-slide-toggle [(ngModel)]="isSortReverse" id="sortReverseBox" aria-label="Reverse Results" class="componentSearchSort__reverseSwitch">Reverse</mat-slide-toggle>
      </span>
      
      
      <span>
        <mat-slide-toggle [(ngModel)]="showActiveComponents" aria-label="Active Components Only" class="componentSearchSort__activeSwitch">Installed</mat-slide-toggle>
      </span>
    </div>
</div>
<!-- Component Details -->
<!-- <div layout="column" class="componentView__details">
  
              <div ng-if="!components">
                  <h4>Click the button to start tracking your first component</h4>
                  <md-button ng-click="sendToAddComponent()">Add A Component</md-button>
              </div>

              <div ng-if="comp.active === activeFlag.show" ng-repeat="comp in components | filter: componentSearch | orderBy:sortOrder:sortReverse.setting">
                  
                  <md-card class="componentView__card">
                      <md-card-header md-colors="{background: 'primary'}" class="componentView__header-c">
                          <md-card-avatar>
                              <md-icon class="componentView__compIcon" md-svg-src="{{comp.type.icon}}"></md-icon>
                          </md-card-avatar>
                          <md-card-header-text class="componentView__compHeader">
                              <span class="md-title compHeader__title"> {{ comp.type.name }}</span>
                              <span class="md-subhead compHeader__subHeader"> {{ comp.brandName }} {{ comp.modelName }}</span>
                          </md-card-header-text>
                          
                          <span flex></span>
                          
                          <md-menu>
                              <md-button aria-label="User menu" class="md-icon-button dotCtrlMenu comp__dotCtrlMenu" ng-click="$mdOpenMenu($event)">
                                  <md-icon md-font-icon="material-icons" class="white">more_vert</md-icon>
                              </md-button>
                              <md-menu-content width="2">
                                  <md-menu-item>
                                      <md-button class="" ng-click="sendToEditComponent(comp)" aria-label="Edit Component">
                                          <md-icon md-font-icon="material-icons" class="">mode_edit</md-icon>Edit
                                      </md-button>
                                  </md-menu-item>
                                  <md-menu-item>
                                      <md-button class="" ng-click="showConfirmComp($event, comp)" aria-label="Delete Component">
                                          <md-icon md-font-icon="material-icons" class="">delete</md-icon>Delete
                                      </md-button>
                                  </md-menu-item>
                              </md-menu-content>
                          </md-menu>
                          
                      </md-card-header>

                      <md-card-content>
                          <span>
                              <h5 layout>
                                  <span>
                                      Mileage:
                                  </span>
                                  <span flex></span>
                                  <span>
                                      <md-checkbox ng-model="comp.active" id="activeComp" class="comp__activeCheckbox" ng-change="changeCompActiveState(comp)">
                                      <label for="activeComp">Installed</label>
                                  </span>
                              </h5>
                              <p>{{ comp.mileage | number }} miles </p>
                          </span>
                          <br>
                          <span ng-if="comp.installationDate" layout>
                              <span ng-show="comp.active">
                                  <h5>Installed for:</h5>
                                 <p ng-show="((todaysDate - comp.installationDate) / 1000 / 3600 / 24 / 30) < 12"> {{ (todaysDate - comp.installationDate) / 1000 / 3600 / 24 / 30 | number:0 }}  months </p>
                                 <p ng-show="((todaysDate - comp.installationDate) / 1000 / 3600 / 24 / 30) > 12"> {{ (todaysDate - comp.installationDate) / 1000 / 3600 / 24 / 30 / 12 | number:1 }}  years </p>
                              </span>   
                              <span flex></span>
                              <span ng-show="comp.active">
                                  <h5>Installation Date:</h5>
                                  <p> {{ comp.installationDate | date }} </p>
                              </span>
                          </span>
                          <br>
                          <v-accordion class="vAccordion--default compview__ExtraDetails">
                              <v-pane>
                                  <v-pane-header class="compExtraDetails__header" aria-controls="{{ comp.fbId }}-content">
                                      More Details...
                                  </v-pane-header>
                      
                                  <v-pane-content aria-labelledby="{{ comp.fbId }}-header">
                                      
                                      <span ng-if="comp.serial">
                                          <h5>Serial:</h5>
                                          <p> {{comp.serial}}</p>
                                      </span>
                                      <span ng-if="comp.type.tips">
                                          <md-button class="md-primary md-raised" ng-href="{{comp.type.tips}}" target="_blank">Maintenance Tips</md-button>
                                      </span>
                                      <span>
                                          <h5 class="compExtraDetails__notesHeader">Notes:</h5>
                                          <p class="compExtraDetails__notes">{{ comp.notes }}</p>
                                      </span>
                                  </v-pane-content>
                              </v-pane>
                          </v-accordion>

                          
                          <div class="card-media" layout layout-align="space-around center" layout-padding layout-wrap layout-fill>
                              <div ng-repeat="image in comp.images" class="compImageWhiteBox" md-whiteframe="{{height}}" ng-init="height = 3" ng-mouseenter="height = 6" ng-mouseleave="height = 3" flex-sm="45" flex-gt-sm="35" layout layout-align="center center">
                                  <img ng-src="{{ image }}" class="compImage" ng-click="displayPhoto($event)"/>
                              </div>
                          </div> 
                          
                      </md-card-content>
                  </md-card>
              </div> 
          </div>  
    </div>
</div>

 -->